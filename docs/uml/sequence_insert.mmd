sequenceDiagram
    autonumber
    participant U as User
    participant UI as Web/Desktop UI
    participant API as FastAPI/Desktop API
    participant DB as Database
    participant T as Table
    participant V as TypeValidator
    participant FS as File System

    Note over U,FS: Row Insertion with Validation and Auto-save

    U->>UI: Fill form and click "Add Row"
    UI->>API: POST /insert_row {table, values}
    API->>DB: get_table(table_name)
    DB-->>API: Table instance
    API->>T: add_row(values)
    T->>V: validate_row(schema, values)
    
    alt Valid Data
        V-->>T: normalized_values
        T->>T: create Row(normalized_values)
        T->>T: append to rows list
        T-->>API: success
        API->>FS: auto_save_database()
        FS-->>API: saved
        API-->>UI: {"status": "ok"}
        UI-->>U: "Row added successfully"
    else Invalid Data
        V-->>T: ValidationError
        T-->>API: error
        API-->>UI: {"error": "validation failed"}
        UI-->>U: "Invalid data format"
    end