@startuml deployment
!theme plain
title TDMS - Deployment Diagram with Cloud Integration

node "Client Machine" <<device>> {
  node "Web Browser" <<browser>> {
    artifact "Web Interface" <<HTML/JS>>
  }
  
  node "Desktop App" <<PyWebView>> {
    artifact "TDMS-Desktop.exe" <<executable>>
  }
}

node "Application Server" <<server>> {
  node "Python Runtime" {
    component "FastAPI" <<service>> {
      artifact "web/main.py"
    }
    
    component "Core Logic" <<library>> {
      artifact "database.py"
      artifact "table.py"
      artifact "operations.py"
      artifact "validator.py"
    }
    
    component "Uvicorn" <<ASGI>>
  }
}

node "Local Storage" <<filesystem>> {
  artifact "databases/*.json" <<JSON>>
}

cloud "Google Cloud" <<cloud>> {
  node "Google Drive" <<storage>> {
    artifact "Database files" <<JSON>>
  }
  
  node "Auth Service" <<OAuth>> {
    artifact "Service Account" <<credentials>>
  }
}

' Connections
"Web Browser" --> "FastAPI" : HTTP:8000
"Desktop App" --> "FastAPI" : localhost:8000
"FastAPI" --> "Core Logic" : imports
"Core Logic" --> "Local Storage" : read/write
"FastAPI" --> "Google Drive" : Drive API v3
"Google Drive" --> "Auth Service" : OAuth 2.0

note right of "Google Cloud"
  Service Account Auth:
  - GOOGLE_SERVICE_ACCOUNT_INFO
  - GOOGLE_SERVICE_ACCOUNT_FILE
end note

note bottom of "Core Logic"
  Variant 58:
  - Union operation
  - date/dateInvl types
end note

@enduml